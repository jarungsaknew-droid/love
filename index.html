<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üíñ</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #f9a8d4, #a78bfa, #7dd3fc);
      font-family: "Prompt", sans-serif;
      overflow: hidden;
    }

    /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß */
    .stars {
      position: absolute;
      width: 100%;
      height: 100%;
      background: radial-gradient(white, transparent) repeat;
      background-size: 3px 3px;
      animation: twinkle 3s infinite;
      z-index: 0;
      pointer-events: none;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.9; }
      50% { opacity: 0.4; }
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á scratch card */
    .scratch-container {
      position: relative;
      width: 360px;
      height: 220px;
      z-index: 1;
    }

    .hidden-message {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2em;
      font-weight: bold;
      color: white;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      text-shadow: 0 0 20px #ff80b5, 0 0 35px #ffd6e0;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      border-radius: 20px;
      cursor: grab;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <div class="stars"></div>

  <div class="scratch-container">
    <div class="hidden-message">‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üíñ</div>
    <canvas id="scratch"></canvas>
  </div>

  <!-- ‡∏î‡∏ô‡∏ï‡∏£‡∏µ‡πÄ‡∏ö‡∏≤ ‡πÜ -->
  <audio id="bgm" autoplay loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_3becc9f62f.mp3?filename=romantic-piano-ambient-112199.mp3" type="audio/mpeg">
  </audio>

  <script>
    const canvas = document.getElementById("scratch");
    const ctx = canvas.getContext("2d");
    const container = document.querySelector(".scratch-container");
    const hiddenMessage = document.querySelector(".hidden-message");

    canvas.width = container.offsetWidth;
    canvas.height = container.offsetHeight;

    // ‡∏ß‡∏≤‡∏î‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏Å‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ö gradient ‡∏™‡∏î‡πÉ‡∏™
    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
    gradient.addColorStop(0, "#f472b6");
    gradient.addColorStop(1, "#c084fc");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    let isDrawing = false;

    function startDraw(e) {
      isDrawing = true;
      scratch(e);
    }

    function endDraw() {
      isDrawing = false;
      ctx.beginPath();
      checkReveal();
    }

    function scratch(e) {
      if (!isDrawing) return;
      const rect = canvas.getBoundingClientRect();
      const x = (e.clientX || e.touches[0].clientX) - rect.left;
      const y = (e.clientY || e.touches[0].clientY) - rect.top;

      ctx.globalCompositeOperation = "destination-out";
      ctx.beginPath();
      ctx.arc(x, y, 25, 0, Math.PI * 2);
      ctx.fill();
    }

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ç‡∏±‡∏î‡∏≠‡∏≠‡∏Å
    function checkReveal() {
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      let cleared = 0;
      for (let i = 3; i < imageData.data.length; i += 4) {
        if (imageData.data[i] === 0) cleared++;
      }
      const percent = cleared / (canvas.width * canvas.height) * 100;
      if (percent > 60) {
        canvas.style.transition = "opacity 1s ease";
        canvas.style.opacity = 0;
        setTimeout(() => canvas.remove(), 1000);
      }
    }

    // Event listeners
    canvas.addEventListener("mousedown", startDraw);
    canvas.addEventListener("mouseup", endDraw);
    canvas.addEventListener("mousemove", scratch);

    canvas.addEventListener("touchstart", startDraw);
    canvas.addEventListener("touchend", endDraw);
    canvas.addEventListener("touchmove", scratch);

    // ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ö‡∏≤ ‡πÜ
    const bgm = document.getElementById("bgm");
    bgm.volume = 0.3;
  </script>
</body>
</html>
